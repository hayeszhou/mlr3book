<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Basics | mlr3 book</title>
<meta name="author" content="Marc Becker">
<meta name="author" content="Martin Binder">
<meta name="author" content="Bernd Bischl">
<meta name="author" content="Lars Kotthoff">
<meta name="author" content="Michel Lang">
<meta name="author" content="Florian Pfisterer">
<meta name="author" content="Nicholas G. Reich">
<meta name="author" content="Jakob Richter">
<meta name="author" content="Patrick Schratz">
<meta name="author" content="Raphael Sonabend">
<meta name="author" content="Damir Pulatov">
<meta name="description" content="This chapter will teach you the essential building blocks of mlr3, as well as its R6 classes and operations used for machine learning. A typical machine learning workflow looks like this: The...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="2 Basics | mlr3 book">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlr3book.mlr-org.com/basics.html">
<meta property="og:image" content="https://mlr3book.mlr-org.com//block.png">
<meta property="og:description" content="This chapter will teach you the essential building blocks of mlr3, as well as its R6 classes and operations used for machine learning. A typical machine learning workflow looks like this: The...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2 Basics | mlr3 book">
<meta name="twitter:description" content="This chapter will teach you the essential building blocks of mlr3, as well as its R6 classes and operations used for machine learning. A typical machine learning workflow looks like this: The...">
<meta name="twitter:image" content="https://mlr3book.mlr-org.com//block.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">mlr3 book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Quickstart</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction and Overview</a></li>
<li><a class="active" href="basics.html"><span class="header-section-number">2</span> Basics</a></li>
<li><a class="" href="perf-eval-cmp.html"><span class="header-section-number">3</span> Performance Evaluation and Comparison</a></li>
<li><a class="" href="optimization.html"><span class="header-section-number">4</span> Model Optimization</a></li>
<li><a class="" href="pipelines.html"><span class="header-section-number">5</span> Pipelines</a></li>
<li><a class="" href="technical.html"><span class="header-section-number">6</span> Technical</a></li>
<li><a class="" href="extending.html"><span class="header-section-number">7</span> Extending</a></li>
<li><a class="" href="special-tasks.html"><span class="header-section-number">8</span> Special Tasks</a></li>
<li><a class="" href="interpretation.html"><span class="header-section-number">9</span> Model Interpretation</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">10</span> Appendix</a></li>
<li><a class="" href="citation-info.html">Citation Info</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mlr-org/mlr3book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basics" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Basics<a class="anchor" aria-label="anchor" href="#basics"><i class="fas fa-link"></i></a>
</h1>
<p>This chapter will teach you the essential building blocks of <a href="https://mlr3.mlr-org.com">mlr3</a>, as well as its <a href="https://cran.r-project.org/package=R6">R6</a> classes and operations used for machine learning.
A typical machine learning workflow looks like this:</p>
<div class="inline-figure"><img src="images/ml_abstraction.svg" style="display: block; margin: auto;"></div>
<p>The data, which <a href="https://mlr3.mlr-org.com">mlr3</a> encapsulates in <a href="basics.html#tasks">tasks</a>, is split into non-overlapping training and test sets.
As we are interested in models that extrapolate to new data rather than just memorizing the training data, the separate test data allows to objectively evaluate models with respect to generalization.
The training data is given to a machine learning algorithm, which we call a <a href="basics.html#learners">learner</a> in <a href="https://mlr3.mlr-org.com">mlr3</a>.
The <a href="basics.html#learners">learner</a> uses the training data to build a model of the relationship of the input features to the output target values.
This model is then used to produce <a href="basics.html#predicting">predictions</a> on the test data, which are compared to the ground truth values to assess the quality of the model.
<a href="https://mlr3.mlr-org.com">mlr3</a> offers a number of different <a href="basics.html#measure">measures</a> to quantify how well a model performs based on the difference between predicted and actual values.
Usually, this <a href="basics.html#measure">measure</a> is a numeric score.</p>
<p>The process of splitting up data into training and test sets, building a model, and evaluating it can be repeated several times, <a href="perf-eval-cmp.html#resampling">resampling</a> different training and test sets from the original data each time.
Multiple <a href="perf-eval-cmp.html#resampling">resampling iterations</a> allow us to get a better and less biased generalizable performance estimate for a particular type of model.
As data are usually partitioned randomly into training and test sets, a single split can for example produce trainng and test sets that are very different, hence creating to the misleading impression that the particular type of model does not perform well.</p>
<p>In many cases, this simple workflow is not sufficient to deal with real-world data, which may require normalization, imputation of missing values, or feature selection.
We will cover more complex workflows that allow to do this and even more later in the book.</p>
<p>This chapter covers the following topics:</p>
<p><strong>Tasks</strong></p>
<p>Tasks encapsulate the data with meta-information, such as the name of the prediction target column.
We cover how to:</p>
<ul>
<li>access <a href="basics.html#tasks-predefined">predefined tasks</a>,</li>
<li>specify a <a href="basics.html#tasks-types">task type</a>,</li>
<li>create a <a href="basics.html#tasks-creation">task</a>,</li>
<li>work with a task’s <a href="basics.html#tasks-api">API</a>,</li>
<li>assign roles to <a href="basics.html#tasks-roles">rows and columns</a> of a task,</li>
<li>implement <a href="basics.html#tasks-mutators">task mutators</a>, and</li>
<li>
<a href="basics.html#tasks-retrieving">retrieve the data</a> that is stored in a task.</li>
</ul>
<p><strong>Learners</strong></p>
<p><a href="basics.html#learners">Learners</a> encapsulate machine learning algorithms to train models and make predictions for a <a href="basics.html#tasks">task</a>.
These are provided other packages.
We cover how to:</p>
<ul>
<li>access the set of <a href="basics.html#predefined-learners">classification and regression learners</a> that come with mlr3 and retrieve a specific learner (more types of learners are covered later in the book),</li>
<li>access the set of <a href="basics.html#learner-api">hyperparameter values</a> of a learner and modify them.</li>
</ul>
<p>How to extend learners and implement your own is covered in a supplemental <a href="extending.html#extending-learners">advanced technical section</a>.</p>
<p><strong>Train and predict</strong></p>
<p>The section on the <a href="basics.html#train-predict">train and predict methods</a> illustrates how to use <a href="basics.html#tasks">tasks</a> and <a href="basics.html#learners">learners</a> to train a model and make <a href="basics.html#predicting">predictions</a> on a new data set.
In particular, we cover how to:</p>
<ul>
<li>properly set up <a href="basics.html#train-predict-objects">tasks</a> and <a href="basics.html#train-predict-objects">learners</a> for training and prediction,</li>
<li>set up <a href="basics.html#split-data">train and test splits</a> for a task,</li>
<li>
<a href="basics.html#training">train</a> the learner on the training set to produce a model,</li>
<li>run the model on the test set to produce <a href="basics.html#predicting">predictions</a>, and</li>
<li>assess the <a href="basics.html#measure">performance</a> of the model by comparing predicted and actual values.</li>
</ul>
<p><span class="math inline">\(~~~~~~~~~~~\)</span></p>
<p>Before we get into the details of how to use <a href="https://mlr3.mlr-org.com">mlr3</a> for machine learning, we give a brief introduction to R6 as it is a relatively new part of R.
<a href="https://mlr3.mlr-org.com">mlr3</a> heavily relies on R6 and all basic building blocks it provides are R6 classes:</p>
<ul>
<li>
<a href="basics.html#tasks">tasks</a>,</li>
<li>
<a href="basics.html#learners">learners</a>,</li>
<li>
<a href="appendix.html#list-measures">measures</a>, and</li>
<li>
<a href="perf-eval-cmp.html#resampling">resamplings</a>.</li>
</ul>
<div id="r6" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Quick R6 Intro for Beginners<a class="anchor" aria-label="anchor" href="#r6"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://cran.r-project.org/package=R6">R6</a> is one of R’s more recent dialects for object-oriented programming (OO).
It addresses shortcomings of earlier OO implementations in R, such as S3, which we used in <a href="https://mlr.mlr-org.com">mlr</a>.
If you have done any object-oriented programming before, R6 should feel familiar.
We focus on the parts of R6 that you need to know to use <a href="https://mlr3.mlr-org.com">mlr3</a> here.</p>
<ul>
<li>Objects are created by calling the constructor of an <a href="https://www.rdocumentation.org/packages/R6/topics/R6Class"><code>R6::R6Class()</code></a> object, specifically the initialization method <code>$new()</code>.
For example, <code>foo = Foo$new(bar = 1)</code> creates a new object of class <code>Foo</code>, setting the <code>bar</code> argument of the constructor to the value <code>1</code>.
Most objects in mlr3 are created through special functions (e.g. <code>lrn("regr.rpart")</code>) that encapsulate this and are also referred to as <em>sugar functions</em>.</li>
<li>Objects have mutable state that is encapsulated in their fields, which can be accessed through the dollar operator.
We can access the <code>bar</code> value in the <code>foo</code> variable from above through <code>foo$bar</code> and set its value by assigning the field, e.g. <code>foo$bar = 2</code>.</li>
<li>In addition to fields, objects expose methods that allow to inspect the object’s state, retrieve information, or perform an action that changes the internal state of the object.
For example, the <code>$train</code> method of a learner changes the internal state of the learner by building and storing a trained model, which can then be used to make predictions, given data.</li>
<li>Objects can have public and private fields and methods.
The public fields and methods define the API to interact with the object.
Private methods are only relevant for you if you want to extend mlr3, e.g. with new learners.</li>
<li>R6 objects are internally environments, and as such have reference semantics.
For example, <code>foo2 = foo</code> does not create a copy of <code>foo</code> in <code>foo2</code>, but another reference to the same actual object.
Setting <code>foo$bar = 3</code> will also change <code>foo2$bar</code> to <code>3</code> and vice versa.</li>
<li>To copy an object, use the <code>$clone()</code> method and the <code>deep = TRUE</code> argument for nested objects, for example, <code>foo2 = foo$clone(deep = TRUE)</code>.</li>
</ul>
<p>For more details on R6, have a look at the excellent <a href="https://r6.r-lib.org/">R6 vignettes</a>, especially the <a href="https://r6.r-lib.org/articles/Introduction.html">introduction</a>.</p>

</div>
<div id="tasks" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Tasks<a class="anchor" aria-label="anchor" href="#tasks"><i class="fas fa-link"></i></a>
</h2>
<p>Tasks are objects that contain the (usually tabular) data and additional meta-data to define a machine learning problem.
The meta-data is, for example, the name of the target variable for supervised machine learning problems, or the type of the dataset (e.g. a <em>spatial</em> or <em>survival</em>).
This information is used by specific operations that can be performed on a task.</p>
<div id="tasks-types" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Task Types<a class="anchor" aria-label="anchor" href="#tasks-types"><i class="fas fa-link"></i></a>
</h3>
<p>To create a task from a <a href="https://www.rdocumentation.org/packages/base/topics/data.frame"><code>data.frame()</code></a>, <a href="https://www.rdocumentation.org/packages/data.table/topics/data.table-package"><code>data.table()</code></a> or <a href="https://www.rdocumentation.org/packages/Matrix/topics/Matrix"><code>Matrix()</code></a>, you first need to select the right task type:</p>
<ul>
<li><p><strong>Classification Task</strong>: The target is a label (stored as <code><a href="https://rdrr.io/r/base/character.html">character()</a></code>or<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>) with only relatively few distinct values → <a href="https://mlr3.mlr-org.com/reference/TaskClassif.html"><code>TaskClassif</code></a>.</p></li>
<li><p><strong>Regression Task</strong>: The target is a numeric quantity (stored as <code><a href="https://rdrr.io/r/base/integer.html">integer()</a></code> or <code><a href="https://rdrr.io/r/base/double.html">double()</a></code>) → <a href="https://mlr3.mlr-org.com/reference/TaskRegr.html"><code>TaskRegr</code></a>.</p></li>
<li><p><strong>Survival Task</strong>: The target is the (right-censored) time to an event. More censoring types are currently in development → <a href="https://mlr3proba.mlr-org.com/reference/TaskSurv.html"><code>mlr3proba::TaskSurv</code></a> in add-on package <a href="https://mlr3proba.mlr-org.com">mlr3proba</a>.</p></li>
<li><p><strong>Density Task</strong>: An unsupervised task to estimate the density → <a href="https://mlr3proba.mlr-org.com/reference/TaskDens.html"><code>mlr3proba::TaskDens</code></a> in add-on package <a href="https://mlr3proba.mlr-org.com">mlr3proba</a>.</p></li>
<li><p><strong>Cluster Task</strong>: An unsupervised task type; there is no target and the aim is to identify similar groups within the feature space → <a href="https://mlr3cluster.mlr-org.com/reference/TaskClust.html"><code>mlr3cluster::TaskClust</code></a> in add-on package <a href="https://mlr3cluster.mlr-org.com">mlr3cluster</a>.</p></li>
<li><p><strong>Spatial Task</strong>: Observations in the task have spatio-temporal information (e.g. coordinates) → <a href="https://www.rdocumentation.org/packages/mlr3spatiotempcv/topics/TaskRegrST"><code>mlr3spatiotempcv::TaskRegrST</code></a> or <a href="https://www.rdocumentation.org/packages/mlr3spatiotempcv/topics/TaskClassifST"><code>mlr3spatiotempcv::TaskClassifST</code></a> in add-on package <a href="https://mlr3spatiotempcv.mlr-org.com">mlr3spatiotempcv</a>.</p></li>
<li><p><strong>Ordinal Regression Task</strong>: The target is ordinal → <code>TaskOrdinal</code> in add-on package <a href="https://github.com/mlr-org/mlr3ordinal">mlr3ordinal</a> (still in development).</p></li>
</ul>
</div>
<div id="tasks-creation" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Task Creation<a class="anchor" aria-label="anchor" href="#tasks-creation"><i class="fas fa-link"></i></a>
</h3>
<p>As an example, we will create a regression task using the <a href="https://www.rdocumentation.org/packages/datasets/topics/mtcars"><code>mtcars</code></a> data set from the package <code>datasets</code>.
It contains characteristics for different types of cars, along with their fuel consumption.
We predict the numeric target variable <code>"mpg"</code> (miles per gallon).
We only consider the first two features in the dataset for brevity.</p>
<p>First, we load and prepare the data, outputting it as a string to get a better idea of what it looks like.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mtcars"</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span>
<span class="va">data</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    32 obs. of  3 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...</code></pre>
<p>Next, we create a regression task, i.e. we construct a new instance of the R6 class <a href="https://mlr3.mlr-org.com/reference/TaskRegr.html"><code>TaskRegr</code></a>.
Usually, this is done by calling the constructor <code>TaskRegr$new()</code>.
Instead, we are calling the converter <a href="https://mlr3.mlr-org.com/reference/as_task_regr.html"><code>as_task_regr()</code></a> to convert our <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> stored in the variable <code>data</code> to a task and provide the following information:</p>
<ol style="list-style-type: decimal">
<li>
<code>x</code>: Object to convert. Works for <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>/<code>data.table()</code>/<code>tibble()</code> abstract data backends implemented in the class <a href="https://mlr3.mlr-org.com/reference/DataBackendDataTable.html"><code>DataBackendDataTable</code></a>.
The latter allows to connect to out-of-memory storage systems like SQL servers via the extension package <a href="https://mlr3db.mlr-org.com">mlr3db</a>.</li>
<li>
<code>target</code>: The name of the prediction target column for the regression problem.</li>
<li>
<code>id</code> (optional): An arbitrary identifier for the task, used in plots and summaries.
If not provided, the deparsed name of <code>x</code> will be used.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3.mlr-org.com">"mlr3"</a></span><span class="op">)</span>

<span class="va">task_mtcars</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_task_regr.html">as_task_regr</a></span><span class="op">(</span><span class="va">data</span>, target <span class="op">=</span> <span class="st">"mpg"</span>, id <span class="op">=</span> <span class="st">"cars"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">task_mtcars</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;TaskRegr:cars&gt; (32 x 3)
## * Target: mpg
## * Properties: -
## * Features (2):
##   - dbl (2): cyl, disp</code></pre>
<p>The <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method gives a short summary of the task:
It has 32 observations and 3 columns, of which 2 are features.</p>
<p>We can also plot the task using the <a href="https://mlr3viz.mlr-org.com">mlr3viz</a> package, which gives a graphical summary of its properties:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3viz.mlr-org.com">"mlr3viz"</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task_mtcars</span>, type <span class="op">=</span> <span class="st">"pairs"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-003-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Note that instead of loading all the extension packages individually, it is often more convenient to load the <a href="https://mlr3verse.mlr-org.com">mlr3verse</a> package instead.
<code>mlr3verse</code> imports most <code>mlr3</code> packages and re-exports functions which are used for common machine learning and data science tasks.</p>
</div>
<div id="tasks-predefined" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Predefined tasks<a class="anchor" aria-label="anchor" href="#tasks-predefined"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://mlr3.mlr-org.com">mlr3</a> includes a few predefined machine learning tasks.
All tasks are stored in an R6 <a href="https://mlr3misc.mlr-org.com/reference/Dictionary.html"><code>Dictionary</code></a> (a key-value store) named <a href="https://mlr3.mlr-org.com/reference/mlr_tasks.html"><code>mlr_tasks</code></a>.
Printing it gives the keys (the names of the datasets):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mlr_tasks</span></code></pre></div>
<pre><code>## &lt;DictionaryTask&gt; with 11 stored values
## Keys: boston_housing, breast_cancer, german_credit, iris, mtcars,
##   penguins, pima, sonar, spam, wine, zoo</code></pre>
<p>We can get a more informative summary of the example tasks by converting the dictionary to a <a href="https://www.rdocumentation.org/packages/data.table/topics/data.table-package"><code>data.table()</code></a> object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">mlr_tasks</span><span class="op">)</span></code></pre></div>
<pre><code>##                key task_type nrow ncol properties lgl int dbl chr fct ord pxc
##  1: boston_housing      regr  506   19              0   3  13   0   2   0   0
##  2:  breast_cancer   classif  683   10   twoclass   0   0   0   0   0   9   0
##  3:  german_credit   classif 1000   21   twoclass   0   3   0   0  14   3   0
##  4:           iris   classif  150    5 multiclass   0   0   4   0   0   0   0
##  5:         mtcars      regr   32   11              0   0  10   0   0   0   0
##  6:       penguins   classif  344    8 multiclass   0   3   2   0   2   0   0
##  7:           pima   classif  768    9   twoclass   0   0   8   0   0   0   0
##  8:          sonar   classif  208   61   twoclass   0   0  60   0   0   0   0
##  9:           spam   classif 4601   58   twoclass   0   0  57   0   0   0   0
## 10:           wine   classif  178   14 multiclass   0   2  11   0   0   0   0
## 11:            zoo   classif  101   17 multiclass  15   1   0   0   0   0   0</code></pre>
<p>Above, the columns <code>"lgl"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/logical"><code>logical</code></a>), <code>"int"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/integer"><code>integer</code></a>), <code>"dbl"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/double"><code>double</code></a>), <code>"chr"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/character"><code>character</code></a>), <code>"fct"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/factor"><code>factor</code></a>), <code>"ord"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/factor"><code>ordered factor</code></a>) and <code>"pxc"</code> (<a href="https://www.rdocumentation.org/packages/base/topics/DateTimeClasses"><code>POSIXct</code></a> time) show the number of features in the task of the respective type.</p>
<p>To get a task from the dictionary, use the <code>$get()</code> method from the <code>mlr_tasks</code> class and assign the return value to a new variable
As getting a task from a dictionary is a very common problem, <code>mlr3</code> provides the shortcut function <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>tsk()</code></a>.
Here, we retrieve the <a href="https://mlr3.mlr-org.com/reference/mlr_tasks_penguins.html"><code>palmer penguins task</code></a>, which is provided by the package <a href="https://cran.r-project.org/package=palmerpenguins">palmerpenguins</a>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_penguins</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"penguins"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">task_penguins</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;TaskClassif:penguins&gt; (344 x 8)
## * Target: species
## * Properties: multiclass
## * Features (7):
##   - int (3): body_mass, flipper_length, year
##   - dbl (2): bill_depth, bill_length
##   - fct (2): island, sex</code></pre>
<p>Note that loading extension packages can add to dictionaries such as <a href="https://mlr3.mlr-org.com/reference/mlr_tasks.html"><code>mlr_tasks</code></a>.
For example, <a href="https://mlr3data.mlr-org.com">mlr3data</a> adds some more example and toy tasks for regression and classification, and <a href="https://mlr3proba.mlr-org.com">mlr3proba</a> adds survival and density estimation tasks.
Both packages are loaded automatically when the <a href="https://mlr3verse.mlr-org.com">mlr3verse</a> package is loaded:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3verse.mlr-org.com">"mlr3verse"</a></span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">mlr_tasks</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##                key task_type  nrow ncol
##  1:           actg      surv  1151   13
##  2:   bike_sharing      regr 17379   14
##  3: boston_housing      regr   506   19
##  4:  breast_cancer   classif   683   10
##  5:       faithful      dens   272    1
##  6:           gbcs      surv   686   10
##  7:  german_credit   classif  1000   21
##  8:          grace      surv  1000    8
##  9:           ilpd   classif   583   11
## 10:           iris   classif   150    5
## 11:     kc_housing      regr 21613   20
## 12:           lung      surv   228   10
## 13:      moneyball      regr  1232   15
## 14:         mtcars      regr    32   11
## 15:      optdigits   classif  5620   65
## 16:       penguins   classif   344    8
## 17:           pima   classif   768    9
## 18:         precip      dens    70    1
## 19:           rats      surv   300    5
## 20:          sonar   classif   208   61
## 21:           spam   classif  4601   58
## 22:        titanic   classif  1309   11
## 23:   unemployment      surv  3343    6
## 24:      usarrests     clust    50    4
## 25:           whas      surv   481   11
## 26:           wine   classif   178   14
## 27:            zoo   classif   101   17
##                key task_type  nrow ncol</code></pre>
<p>To get more information about a particular task, the corresponding man page can be found under <code>mlr_tasks_[id]</code>, e.g. <a href="https://mlr3.mlr-org.com/reference/mlr_tasks_german_credit.html"><code>mlr_tasks_german_credit</code></a>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="st">"mlr_tasks_german_credit"</span><span class="op">)</span></code></pre></div>
</div>
<div id="tasks-api" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Task API<a class="anchor" aria-label="anchor" href="#tasks-api"><i class="fas fa-link"></i></a>
</h3>
<p>All properties and characteristics of tasks can be queried using the task’s public fields and methods (see <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a>).
Methods can also be used to change the stored data and the behavior of the task.</p>
<div id="tasks-retrieving" class="section level4" number="2.2.4.1">
<h4>
<span class="header-section-number">2.2.4.1</span> Retrieving Data<a class="anchor" aria-label="anchor" href="#tasks-retrieving"><i class="fas fa-link"></i></a>
</h4>
<p>The data stored in a task can be retrieved directly from fields, for example for <code>task_mtcars</code> that we defined above we can get the number of rows and columns:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span></code></pre></div>
<pre><code>## &lt;TaskRegr:cars&gt; (32 x 3)
## * Target: mpg
## * Properties: -
## * Features (2):
##   - dbl (2): cyl, disp</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span><span class="op">$</span><span class="va">nrow</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span><span class="op">$</span><span class="va">ncol</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>More information can be obtained through methods of the object, for example:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##      mpg cyl  disp
##  1: 21.0   6 160.0
##  2: 21.0   6 160.0
##  3: 22.8   4 108.0
##  4: 21.4   6 258.0
##  5: 18.7   8 360.0
##  6: 18.1   6 225.0
##  7: 14.3   8 360.0
##  8: 24.4   4 146.7
##  9: 22.8   4 140.8
## 10: 19.2   6 167.6
## 11: 17.8   6 167.6
## 12: 16.4   8 275.8
## 13: 17.3   8 275.8
## 14: 15.2   8 275.8
## 15: 10.4   8 472.0
## 16: 10.4   8 460.0
## 17: 14.7   8 440.0
## 18: 32.4   4  78.7
## 19: 30.4   4  75.7
## 20: 33.9   4  71.1
## 21: 21.5   4 120.1
## 22: 15.5   8 318.0
## 23: 15.2   8 304.0
## 24: 13.3   8 350.0
## 25: 19.2   8 400.0
## 26: 27.3   4  79.0
## 27: 26.0   4 120.3
## 28: 30.4   4  95.1
## 29: 15.8   8 351.0
## 30: 19.7   6 145.0
## 31: 15.0   8 301.0
## 32: 21.4   4 121.0
##      mpg cyl  disp</code></pre>
<p>In <a href="https://mlr3.mlr-org.com">mlr3</a>, each row (observation) has a unique identifier, stored as an <code><a href="https://rdrr.io/r/base/integer.html">integer()</a></code>.
These can be passed as arguments to the <code>$data()</code> method to select specific rows:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">task_mtcars</span><span class="op">$</span><span class="va">row_ids</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve data for rows with IDs 1, 5, and 10</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##     mpg cyl  disp
## 1: 21.0   6 160.0
## 2: 18.7   8 360.0
## 3: 19.2   6 167.6</code></pre>
<p>Note that although the row IDs are typically just the sequence from <code>1</code> to <code>nrow(data)</code>, they are only guaranteed to be unique natural numbers.
Keep that in mind, especially if you work with data stored in a real data base management system (see <a href="technical.html#backends">backends</a>).</p>
<p>Similarly to row IDs, target and feature columns also have unique identifiers, i.e. names (stored as <code><a href="https://rdrr.io/r/base/character.html">character()</a></code>).
Their names can be accessed via the public slots <code>$feature_names</code> and <code>$target_names</code>.
Here, “target” refers to the variable we want to predict and “feature” to the predictors for the task.
The target will usually be only a single name.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span><span class="op">$</span><span class="va">feature_names</span></code></pre></div>
<pre><code>## [1] "cyl"  "disp"</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_mtcars</span><span class="op">$</span><span class="va">target_names</span></code></pre></div>
<pre><code>## [1] "mpg"</code></pre>
<p>The <code>row_ids</code> and column names can be combined when selecting a subset of the data:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve data for rows 1, 5, and 10 and only select column "mpg"</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, cols <span class="op">=</span> <span class="st">"mpg"</span><span class="op">)</span></code></pre></div>
<pre><code>##     mpg
## 1: 21.0
## 2: 18.7
## 3: 19.2</code></pre>
<p>To extract the complete data from the task, one can also simply convert it to a <code>data.table</code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show summary of entire data</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">task_mtcars</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##       mpg            cyl            disp      
##  Min.   :10.4   Min.   :4.00   Min.   : 71.1  
##  1st Qu.:15.4   1st Qu.:4.00   1st Qu.:120.8  
##  Median :19.2   Median :6.00   Median :196.3  
##  Mean   :20.1   Mean   :6.19   Mean   :230.7  
##  3rd Qu.:22.8   3rd Qu.:8.00   3rd Qu.:326.0  
##  Max.   :33.9   Max.   :8.00   Max.   :472.0</code></pre>
</div>
<div id="binary-classification" class="section level4" number="2.2.4.2">
<h4>
<span class="header-section-number">2.2.4.2</span> Binary classification<a class="anchor" aria-label="anchor" href="#binary-classification"><i class="fas fa-link"></i></a>
</h4>
<p>Classification problems with a target variable with only two classes are called binary classification tasks.
They are special in the sense that one of these classes is denoted <em>positive</em> and the other one <em>negative</em>.
You can specify the <em>positive class</em> within the <a href="https://mlr3.mlr-org.com/reference/TaskClassif.html"><code>classification task</code></a> object during task creation.
If not explicitly set during construction, the positive class defaults to the first level of the target variable.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># during construction</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Sonar"</span>, package <span class="op">=</span> <span class="st">"mlbench"</span><span class="op">)</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_task_classif.html">as_task_classif</a></span><span class="op">(</span><span class="va">Sonar</span>, target <span class="op">=</span> <span class="st">"Class"</span>, positive <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span>

<span class="co"># switch positive class to level 'M'</span>
<span class="va">task</span><span class="op">$</span><span class="va">positive</span> <span class="op">=</span> <span class="st">"M"</span></code></pre></div>
</div>
<div id="tasks-roles" class="section level4" number="2.2.4.3">
<h4>
<span class="header-section-number">2.2.4.3</span> Roles (Rows and Columns)<a class="anchor" aria-label="anchor" href="#tasks-roles"><i class="fas fa-link"></i></a>
</h4>
<p>We have seen that during task creation, target and feature roles are assigned to columns.
Target refers to the variable we want to predict and features are the predictors (also called co-variates) for the target.
It is possible to assign different roles to rows and columns.
These roles affect the behavior of the task for different operations.
For other possible roles and their meaning, see the documentation of <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a>.</p>
<p>For example, the previously-constructed <code>task_mtcars</code> task has the following column roles:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">task_mtcars</span><span class="op">$</span><span class="va">col_roles</span><span class="op">)</span></code></pre></div>
<pre><code>## $feature
## [1] "cyl"  "disp"
## 
## $target
## [1] "mpg"
## 
## $name
## character(0)
## 
## $order
## character(0)
## 
## $stratum
## character(0)
## 
## $group
## character(0)
## 
## $weight
## character(0)</code></pre>
<p>Columns can have no role (they are ignored) or have multiple roles.
To add the row names of <code>task_mtcars</code> as an additional feature, we first add them to the underlying data as regular column and then recreate the task with the new column.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># with `keep.rownames`, data.table stores the row names in an extra column "rn"</span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/mtcars.html">mtcars</a></span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, keep.rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">task_mtcars</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_task_regr.html">as_task_regr</a></span><span class="op">(</span><span class="va">data</span>, target <span class="op">=</span> <span class="st">"mpg"</span>, id <span class="op">=</span> <span class="st">"cars"</span><span class="op">)</span>

<span class="co"># there is a new feature called "rn"</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="va">feature_names</span></code></pre></div>
<pre><code>## [1] "cyl"  "disp" "rn"</code></pre>
<p>The row names are now a feature whose values are stored in the column <code>"rn"</code>.
We include this column here for educational purposes only.
Generally speaking, there is no point in having a feature that uniquely identifies each row.
Furthermore, the character data type will cause problems with many types of machine learning algorithms.</p>
<p>The identifier may be useful to label points in plots, for example to identify outliers.
To achieve this, we will change the role of the <code>rn</code> column by removing it from the list of features and assign the new role <code>"name"</code>.
There are two ways to do this:</p>
<ol style="list-style-type: decimal">
<li>Use the <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a> method <code>$set_col_roles()</code> (recommended).</li>
<li>Simply modify the field <code>$col_roles</code>, which is a named list of vectors of column names.
Each vector in this list corresponds to a column role, and the column names contained in that vector have that role.</li>
</ol>
<p>Supported column roles can be found in the manual of <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a>, or just by printing the names of the field <code>$col_roles</code>:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># supported column roles, see ?Task</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">task_mtcars</span><span class="op">$</span><span class="va">col_roles</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "feature" "target"  "name"    "order"   "stratum" "group"   "weight"</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assign column "rn" the role "name", remove from other roles</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="fu">set_col_roles</span><span class="op">(</span><span class="st">"rn"</span>, roles <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span>

<span class="co"># note that "rn" not listed as feature anymore</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="va">feature_names</span></code></pre></div>
<pre><code>## [1] "cyl"  "disp"</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># "rn" also does not appear anymore when we access the data</span>
<span class="va">task_mtcars</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##    mpg cyl disp
## 1:  21   6  160
## 2:  21   6  160</code></pre>
<p>Changing the role does not change the underlying data, it just updates the view on it.
The data is not copied in the code above.
The view is changed in-place though, i.e. the task object itself is modified.</p>
<p>Just like columns, it is also possible to assign different roles to rows.</p>
<p>Rows can have two different roles:</p>
<ol style="list-style-type: decimal">
<li><p>Role <code>use</code>:
Rows that are generally available for model fitting (although they may also be used as test set in resampling).
This role is the default role.</p></li>
<li><p>Role <code>validation</code>:
Rows that are not used for training.
Rows that have missing values in the target column during task creation are automatically set to the validation role.</p></li>
</ol>
<p>There are several reasons to hold some observations back or treat them differently:</p>
<ol style="list-style-type: decimal">
<li>It is often good practice to validate the final model on an external validation set to identify possible overfitting.</li>
<li>Some observations may be unlabeled, e.g. in competitions like <a href="https://www.kaggle.com/">Kaggle</a>.</li>
</ol>
<p>These observations cannot be used for training a model, but can be used to get predictions.</p>
</div>
<div id="tasks-mutators" class="section level4" number="2.2.4.4">
<h4>
<span class="header-section-number">2.2.4.4</span> Task Mutators<a class="anchor" aria-label="anchor" href="#tasks-mutators"><i class="fas fa-link"></i></a>
</h4>
<p>As shown above, modifying <code>$col_roles</code> or <code>$row_roles</code> (either via <code>set_col_roles()</code>/<code>set_row_roles()</code> or directly by modifying the named list) changes the view on the data.
The additional convenience method <code>$filter()</code> subsets the current view based on row IDs and <code>$select()</code> subsets the view based on feature names.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_penguins</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"penguins"</span><span class="op">)</span>
<span class="va">task_penguins</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"body_mass"</span>, <span class="st">"flipper_length"</span><span class="op">)</span><span class="op">)</span> <span class="co"># keep only these features</span>
<span class="va">task_penguins</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="co"># keep only these rows</span>
<span class="va">task_penguins</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##    species body_mass flipper_length
## 1:  Adelie      3750            181
## 2:  Adelie      3800            186
## 3:  Adelie      3250            195</code></pre>
<p>While the methods above allow us to subset the data, the methods <code>$rbind()</code> and <code>$cbind()</code> allow to add extra rows and columns to a task.
Again, the original data is not changed.
The additional rows or columns are only added to the view of the data.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task_penguins</span><span class="op">$</span><span class="fu">cbind</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>letters <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># add column letters</span>
<span class="va">task_penguins</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##    species body_mass flipper_length letters
## 1:  Adelie      3750            181       a
## 2:  Adelie      3800            186       b
## 3:  Adelie      3250            195       c</code></pre>
</div>
</div>
<div id="autoplot-task" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> Plotting Tasks<a class="anchor" aria-label="anchor" href="#autoplot-task"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://mlr3viz.mlr-org.com">mlr3viz</a> package provides plotting facilities for many classes implemented in <a href="https://mlr3.mlr-org.com">mlr3</a>.
The available plot types depend on the class, but all plots are returned as <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> objects which can be easily customized.</p>
<p>For classification tasks (inheriting from <a href="https://mlr3.mlr-org.com/reference/TaskClassif.html"><code>TaskClassif</code></a>), see the documentation of <a href="https://mlr3viz.mlr-org.com/reference/autoplot.TaskClassif.html"><code>mlr3viz::autoplot.TaskClassif</code></a> for the implemented plot types.
Here are some examples to get an impression:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3viz.mlr-org.com">"mlr3viz"</a></span><span class="op">)</span>

<span class="co"># get the pima indians task</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"pima"</span><span class="op">)</span>

<span class="co"># subset task to only use the 3 first features</span>
<span class="va">task</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">feature_names</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="co"># default plot: class frequencies</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-019-1.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pairs plot (requires package GGally)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task</span>, type <span class="op">=</span> <span class="st">"pairs"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-019-2.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># duo plot (requires package GGally)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task</span>, type <span class="op">=</span> <span class="st">"duo"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-019-3.svg" width="672" style="display: block; margin: auto;"></div>
<p>Of course, you can do the same for regression tasks (inheriting from <a href="https://mlr3.mlr-org.com/reference/TaskRegr.html"><code>TaskRegr</code></a>) as documented in <a href="https://mlr3viz.mlr-org.com/reference/autoplot.TaskRegr.html"><code>mlr3viz::autoplot.TaskRegr</code></a>:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3viz.mlr-org.com">"mlr3viz"</a></span><span class="op">)</span>

<span class="co"># get the complete mtcars task</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span>

<span class="co"># subset task to only use the 3 first features</span>
<span class="va">task</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">feature_names</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="co"># default plot: boxplot of target variable</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-020-1.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pairs plot (requires package GGally)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">task</span>, type <span class="op">=</span> <span class="st">"pairs"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-tasks_files/figure-html/02-basics-tasks-020-2.svg" width="672" style="display: block; margin: auto;"></div>

</div>
</div>
<div id="learners" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Learners<a class="anchor" aria-label="anchor" href="#learners"><i class="fas fa-link"></i></a>
</h2>
<p>Objects of class <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> provide a unified interface to many popular machine learning algorithms in R.
They consist of methods to train and predict a model for a <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a> and provide meta-information about the learners, such as the hyperparameters (which control the behavior of the learner) you can set.</p>
<p>The base class of each learner is <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a>, specialized for regression as <a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html"><code>LearnerRegr</code></a> and for classification as <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a>.
Other types of learners, provided by extension packages, also inherit from the <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> base class, e.g. <a href="https://mlr3proba.mlr-org.com/reference/LearnerSurv.html"><code>mlr3proba::LearnerSurv</code></a> or <a href="https://mlr3cluster.mlr-org.com/reference/LearnerClust.html"><code>mlr3cluster::LearnerClust</code></a>.
In contrast to <a href="https://mlr3.mlr-org.com/reference/Task.html"><code>Task</code></a>s, the creation of a custom Learner is usually not required and a more advanced topic.
Hence, we refer the reader to Section <a href="extending.html#extending-learners">7.1</a> and proceed with an overview of the interface of already implemented learners.</p>
<div class="inline-figure">All Learners work in a two-stage procedure:
<img src="images/learner.svg" style="display: block; margin: auto;">
</div>
<ul>
<li>
<strong>training step</strong>: The training data (features and target) is passed to the Learner’s <code>$train()</code> function which trains and stores a model, i.e. the relationship of the target and features.</li>
<li>
<strong>predict step</strong>: The new data, usually a different slice of the original data than used for training, is passed to the <code>$predict()</code> method of the Learner.
The model trained in the first step is used to predict the missing target, e.g. labels for classification problems or the numerical value for regression problems.</li>
</ul>
<div id="predefined-learners" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Predefined Learners<a class="anchor" aria-label="anchor" href="#predefined-learners"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>mlr3</code> package ships with the following set of classification and regression learners.
We deliberately keep this small to avoid unnecessary dependencies:</p>
<ul>
<li>
<a href="https://mlr3.mlr-org.com/reference/mlr_learners_classif.featureless.html"><code>mlr_learners_classif.featureless</code></a>: Simple baseline classification learner (inheriting from <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a>).
The default is to predict the label that is most frequent in the training set every time.</li>
<li>
<a href="https://mlr3.mlr-org.com/reference/mlr_learners_regr.featureless.html"><code>mlr_learners_regr.featureless</code></a>: Simple baseline regression learner (inheriting from <a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html"><code>LearnerRegr</code></a>).
The default is to predict the mean of the target in training set every time.</li>
<li>
<a href="https://mlr3.mlr-org.com/reference/mlr_learners_classif.rpart.html"><code>mlr_learners_classif.rpart</code></a>: Single classification tree from package <a href="https://cran.r-project.org/package=rpart">rpart</a>.</li>
<li>
<a href="https://mlr3.mlr-org.com/reference/mlr_learners_regr.rpart.html"><code>mlr_learners_regr.rpart</code></a>: Single regression tree from package <a href="https://cran.r-project.org/package=rpart">rpart</a>.</li>
</ul>
<p>This set of baseline learners is usually insufficient for a real data analysis.
Thus, we have cherry-picked implementations of the most popular machine learning method and collected them in the <a href="https://mlr3learners.mlr-org.com">mlr3learners</a> package:</p>
<ul>
<li>Linear and logistic regression</li>
<li>Penalized Generalized Linear Models</li>
<li>
<span class="math inline">\(k\)</span>-Nearest Neighbors regression and classification</li>
<li>Kriging</li>
<li>Linear and Quadratic Discriminant Analysis</li>
<li>Naive Bayes</li>
<li>Support-Vector machines</li>
<li>Gradient Boosting</li>
<li>Random Forests for regression, classification and survival</li>
</ul>
<p>More machine learning methods and alternative implementations are collected in the <a href="https://github.com/mlr-org/mlr3extralearners/">mlr3extralearners repository</a>.</p>
<div class="rmdnote">
<p>
A full list of implemented learners across all packages is given in <a href="https://mlr3extralearners.mlr-org.com/articles/learners/list_learners.html">this interactive list</a> and also via <code><a href="https://rdrr.io/pkg/mlr3extralearners/man/list_mlr3learners.html">mlr3extralearners::list_mlr3learners()</a></code>.
</p>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">mlr3extralearners</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mlr3extralearners/man/list_mlr3learners.html">list_mlr3learners</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># show first six learners</span></code></pre></div>
<pre><code>##          name   class                 id      mlr3_package
## 1: AdaBoostM1 classif classif.AdaBoostM1 mlr3extralearners
## 2:       bart classif       classif.bart mlr3extralearners
## 3:        C50 classif        classif.C50 mlr3extralearners
## 4:   catboost classif   classif.catboost mlr3extralearners
## 5:    cforest classif    classif.cforest mlr3extralearners
## 6:      ctree classif      classif.ctree mlr3extralearners
##                           required_packages
## 1:                  mlr3extralearners,RWeka
## 2:                 mlr3extralearners,dbarts
## 3:                    mlr3extralearners,C50
## 4:               mlr3extralearners,catboost
## 5: mlr3extralearners,partykit,sandwich,coin
## 6: mlr3extralearners,partykit,sandwich,coin
##                                         properties
## 1:                             multiclass,twoclass
## 2:                                twoclass,weights
## 3:            missings,multiclass,twoclass,weights
## 4: importance,missings,multiclass,twoclass,weights
## 5:           multiclass,oob_error,twoclass,weights
## 6:                     multiclass,twoclass,weights
##                     feature_types predict_types
## 1:         numeric,factor,ordered response,prob
## 2: integer,numeric,factor,ordered response,prob
## 3:         numeric,factor,ordered response,prob
## 4:         numeric,factor,ordered response,prob
## 5: integer,numeric,factor,ordered response,prob
## 6: integer,numeric,factor,ordered response,prob</code></pre>
<p>The full list of learners uses a large number of extra packages, which sometimes break.
We check the status of each learner’s integration automatically, the latest build status of all learners is shown <a href="https://mlr3extralearners.mlr-org.com/articles/learners/learner_status.html">here</a>.</p>
<p>To get one of the predefined learners, you need to access the <a href="https://mlr3.mlr-org.com/reference/mlr_learners.html"><code>mlr_learners</code></a> <a href="https://mlr3misc.mlr-org.com/reference/Dictionary.html"><code>Dictionary</code></a> which, similar to <a href="https://mlr3.mlr-org.com/reference/mlr_tasks.html"><code>mlr_tasks</code></a>, is automatically populated with more learners by extension packages.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load most mlr3 packages to populate the dictionary</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3verse.mlr-org.com">"mlr3verse"</a></span><span class="op">)</span>
<span class="va">mlr_learners</span></code></pre></div>
<pre><code>## &lt;DictionaryLearner&gt; with 136 stored values
## Keys: classif.AdaBoostM1, classif.bart, classif.C50, classif.catboost,
##   classif.cforest, classif.ctree, classif.cv_glmnet, classif.debug,
##   classif.earth, classif.extratrees, classif.featureless, classif.fnn,
##   classif.gam, classif.gamboost, classif.gausspr, classif.gbm,
##   classif.glmboost, classif.glmnet, classif.IBk, classif.J48,
##   classif.JRip, classif.kknn, classif.ksvm, classif.lda,
##   classif.liblinear, classif.lightgbm, classif.LMT, classif.log_reg,
##   classif.lssvm, classif.mob, classif.multinom, classif.naive_bayes,
##   classif.nnet, classif.OneR, classif.PART, classif.qda,
##   classif.randomForest, classif.ranger, classif.rfsrc, classif.rpart,
##   classif.svm, classif.xgboost, clust.agnes, clust.ap, clust.cmeans,
##   clust.cobweb, clust.dbscan, clust.diana, clust.em, clust.fanny,
##   clust.featureless, clust.ff, clust.hclust, clust.kkmeans,
##   clust.kmeans, clust.MBatchKMeans, clust.meanshift, clust.pam,
##   clust.SimpleKMeans, clust.xmeans, dens.hist, dens.kde, dens.kde_kd,
##   dens.kde_ks, dens.locfit, dens.logspline, dens.mixed, dens.nonpar,
##   dens.pen, dens.plug, dens.spline, regr.bart, regr.catboost,
##   regr.cforest, regr.ctree, regr.cubist, regr.cv_glmnet, regr.debug,
##   regr.earth, regr.extratrees, regr.featureless, regr.fnn, regr.gam,
##   regr.gamboost, regr.gausspr, regr.gbm, regr.glm, regr.glmboost,
##   regr.glmnet, regr.IBk, regr.kknn, regr.km, regr.ksvm, regr.liblinear,
##   regr.lightgbm, regr.lm, regr.M5Rules, regr.mars, regr.mob,
##   regr.randomForest, regr.ranger, regr.rfsrc, regr.rpart, regr.rvm,
##   regr.svm, regr.xgboost, surv.akritas, surv.blackboost, surv.cforest,
##   surv.coxboost, surv.coxph, surv.coxtime, surv.ctree,
##   surv.cv_coxboost, surv.cv_glmnet, surv.deephit, surv.deepsurv,
##   surv.dnnsurv, surv.flexible, surv.gamboost, surv.gbm, surv.glmboost,
##   surv.glmnet, surv.kaplan, surv.loghaz, surv.mboost, surv.nelson,
##   surv.obliqueRSF, surv.parametric, surv.pchazard, surv.penalized,
##   surv.ranger, surv.rfsrc, surv.rpart, surv.svm, surv.xgboost</code></pre>
<p>To obtain an object from the dictionary you can also use the shortcut function <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>lrn()</code></a> or the generic <code>mlr_learners$get()</code> method, e.g. <code>lrn("classif.rpart")</code>.</p>
</div>
<div id="learner-api" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Learner API<a class="anchor" aria-label="anchor" href="#learner-api"><i class="fas fa-link"></i></a>
</h3>
<p>Each learner provides the following meta-information:</p>
<ul>
<li>
<code>feature_types</code>: the type of features the learner can deal with.</li>
<li>
<code>packages</code>: the packages required to train a model with this learner and make predictions.</li>
<li>
<code>properties</code>: additional properties and capabilities.
For example, a learner has the property “missings” if it is able to handle missing feature values, and “importance” if it computes and allows to extract data on the relative importance of the features.
A complete list of these is available in the <a href="https://mlr3.mlr-org.com/reference/mlr_reflections.html#examples">mlr3 reference</a>.</li>
<li>
<code>predict_types</code>: possible prediction types. For example, a classification learner can predict labels (“response”) or probabilities (“prob”). For a complete list of possible predict types see the <a href="https://mlr3.mlr-org.com/reference/mlr_reflections.html#examples">mlr3 reference</a>.</li>
</ul>
<p>You can retrieve a specific learner using its ID:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.rpart"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;LearnerClassifRpart:classif.rpart&gt;
## * Model: -
## * Parameters: xval=0
## * Packages: mlr3, rpart
## * Predict Type: response
## * Feature types: logical, integer, numeric, factor, ordered
## * Properties: importance, missings, multiclass, selected_features,
##   twoclass, weights</code></pre>
<p>Each learner has hyperparameters that control its behavior, for example the minimum number of samples in the leaf of a decision tree, or whether to provide verbose output durning training.
Setting hyperparameters to values appropriate for a given machine learning task is crucial.
The field <code>param_set</code> stores a description of the hyperparameters the learner has, their ranges, defaults, and current values:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span></code></pre></div>
<pre><code>## &lt;ParamSet&gt;
##                 id    class lower upper nlevels        default value
##  1:             cp ParamDbl     0     1     Inf           0.01      
##  2:     keep_model ParamLgl    NA    NA       2          FALSE      
##  3:     maxcompete ParamInt     0   Inf     Inf              4      
##  4:       maxdepth ParamInt     1    30      30             30      
##  5:   maxsurrogate ParamInt     0   Inf     Inf              5      
##  6:      minbucket ParamInt     1   Inf     Inf &lt;NoDefault[3]&gt;      
##  7:       minsplit ParamInt     1   Inf     Inf             20      
##  8: surrogatestyle ParamInt     0     1       2              0      
##  9:   usesurrogate ParamInt     0     2       3              2      
## 10:           xval ParamInt     0   Inf     Inf             10     0</code></pre>
<p>The set of current hyperparameter values is stored in the <code>values</code> field of the <code>param_set</code> field.
You can change the current hyperparameter values by assigning a named list to this field:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="fl">0.01</span>, xval <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">learner</span></code></pre></div>
<pre><code>## &lt;LearnerClassifRpart:classif.rpart&gt;
## * Model: -
## * Parameters: cp=0.01, xval=0
## * Packages: mlr3, rpart
## * Predict Type: response
## * Feature types: logical, integer, numeric, factor, ordered
## * Properties: importance, missings, multiclass, selected_features,
##   twoclass, weights</code></pre>
<p>Note that this operation overwrites all previously set parameters.
You can also get the current set of hyperparameter values, modify it, and write it back to the learner:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pv</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span>
<span class="va">pv</span><span class="op">$</span><span class="va">cp</span> <span class="op">=</span> <span class="fl">0.02</span>
<span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span> <span class="op">=</span> <span class="va">pv</span></code></pre></div>
<p>This sets <code>cp</code> to <code>0.02</code> but keeps any other values that were set previously.</p>
<p>Note that the <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>lrn()</code></a> function also accepts additional arguments to update hyperparameters or set fields of the learner in one go:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, id <span class="op">=</span> <span class="st">"rp"</span>, cp <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">learner</span><span class="op">$</span><span class="va">id</span></code></pre></div>
<pre><code>## [1] "rp"</code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span></code></pre></div>
<pre><code>## $xval
## [1] 0
## 
## $cp
## [1] 0.001</code></pre>
<p>More on this is discussed in the section on <a href="https://mlr3book.mlr-org.com/optimization.html#tuning">Hyperparameter Tuning</a>.</p>
<div id="thresholding" class="section level4" number="2.3.2.1">
<h4>
<span class="header-section-number">2.3.2.1</span> Thresholding<a class="anchor" aria-label="anchor" href="#thresholding"><i class="fas fa-link"></i></a>
</h4>
<p>Models trained on binary classification tasks that predict the probability for the positive class usually use a simple rule to determine the predicted class label: if the probability is more than 50%, predict the positive label, otherwise predict the negative label.
In some cases you may want to adjust this threshold, for example if the classes are very unbalanced (i.e. one is much more prevalent than the other).</p>
<p>In the example below, we change the threshold to 0.2, which improves the True Positive Rate (TPR).
Note that while the new threshold classifies more observations from the positive class correctly, the True Negative Rate (TNR) decreases.
Depending on the application, this may or may not be desired.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Sonar"</span>, package <span class="op">=</span> <span class="st">"mlbench"</span><span class="op">)</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_task_classif.html">as_task_classif</a></span><span class="op">(</span><span class="va">Sonar</span>, target <span class="op">=</span> <span class="st">"Class"</span>, positive <span class="op">=</span> <span class="st">"M"</span><span class="op">)</span>
<span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, predict_type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span><span class="op">)</span>

<span class="va">measures</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">msrs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"classif.tpr"</span>, <span class="st">"classif.tnr"</span><span class="op">)</span><span class="op">)</span> <span class="co"># use msrs() to get a list of multiple measures</span>
<span class="va">pred</span><span class="op">$</span><span class="va">confusion</span></code></pre></div>
<pre><code>##         truth
## response  M  R
##        M 95 10
##        R 16 87</code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></code></pre></div>
<pre><code>## classif.tpr classif.tnr 
##      0.8559      0.8969</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred</span><span class="op">$</span><span class="fu">set_threshold</span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>
<span class="va">pred</span><span class="op">$</span><span class="va">confusion</span></code></pre></div>
<pre><code>##         truth
## response   M   R
##        M 104  25
##        R   7  72</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></code></pre></div>
<pre><code>## classif.tpr classif.tnr 
##      0.9369      0.7423</code></pre>
<p>Thresholds can be tuned automatically with respect to a performance measure with the <a href="https://mlr3pipelines.mlr-org.com">mlr3pipelines</a> package, i.e. using <a href="https://mlr3pipelines.mlr-org.com/reference/mlr_pipeops_tunethreshold.html"><code>PipeOpTuneThreshold</code></a>.</p>

</div>
</div>
</div>
<div id="train-predict" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Train, Predict, Assess Performance<a class="anchor" aria-label="anchor" href="#train-predict"><i class="fas fa-link"></i></a>
</h2>
<p>In this section, we explain how <a href="basics.html#tasks">tasks</a> and <a href="basics.html#learners">learners</a> can be used to train a model and predict on a new dataset.
The concept is demonstrated on a supervised classification task using the <a href="https://mlr3.mlr-org.com/reference/mlr_tasks_penguins.html"><code>penguins</code></a> dataset and the <a href="https://mlr3.mlr-org.com/reference/mlr_learners_classif.rpart.html"><code>rpart</code></a> learner, which builds a single classification tree.</p>
<p>Training a <a href="basics.html#learners">learner</a> means fitting a model to a given data set – essentially an optimization problem that determines the best parameters (not hyperparameters!) of the model given the data.
We then <a href="basics.html#predicting">predict</a> the label for observations that the model has not seen during training.
These <a href="basics.html#predicting">predictions</a> are compared to the ground truth values in order to assess the predictive performance of the model.</p>
<div id="train-predict-objects" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Creating Task and Learner Objects<a class="anchor" aria-label="anchor" href="#train-predict-objects"><i class="fas fa-link"></i></a>
</h3>
<p>First of all, we load the <a href="https://mlr3verse.mlr-org.com">mlr3verse</a> package, which will load all other packages we need here.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3verse.mlr-org.com">"mlr3verse"</a></span><span class="op">)</span></code></pre></div>
<p>Now, we retrieve the task and the learner from <a href="https://mlr3.mlr-org.com/reference/mlr_tasks.html"><code>mlr_tasks</code></a> (with shortcut <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>tsk()</code></a>) and <a href="https://mlr3.mlr-org.com/reference/mlr_learners.html"><code>mlr_learners</code></a> (with shortcut <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>lrn()</code></a>), respectively:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"penguins"</span><span class="op">)</span>
<span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.rpart"</span><span class="op">)</span></code></pre></div>
</div>
<div id="split-data" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Setting up the train/test splits of the data<a class="anchor" aria-label="anchor" href="#split-data"><i class="fas fa-link"></i></a>
</h3>
<p>It is common to train on a majority of the data, to give the learner a better chance of fitting a good model.
Here we use 80% of all available observations to train and predict on the remaining 20%.
For this purpose, we create two index vectors:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">nrow</span>, <span class="fl">0.8</span> <span class="op">*</span> <span class="va">task</span><span class="op">$</span><span class="va">nrow</span><span class="op">)</span>
<span class="va">test_set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">nrow</span><span class="op">)</span>, <span class="va">train_set</span><span class="op">)</span></code></pre></div>
<p>In Section <a href="perf-eval-cmp.html#resampling">3.2</a> we will learn how mlr3 can automatically create training and test sets based on different <a href="perf-eval-cmp.html#resampling">resampling</a> strategies.</p>
</div>
<div id="training" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> Training the learner<a class="anchor" aria-label="anchor" href="#training"><i class="fas fa-link"></i></a>
</h3>
<p>The field <code>$model</code> stores the model that is produced in the training step.
Before the <code>$train()</code> method is called on a learner object, this field is <code>NULL</code>:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="va">model</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Now we fit the classification tree using the training set of the task by calling the <code>$train()</code> method of <code>learner</code>:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="va">train_set</span><span class="op">)</span></code></pre></div>
<p>This operation modifies the learner in-place by adding the fitted model to the existing object.
We can now access the stored model via the field <code>$model</code>:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></code></pre></div>
<pre><code>## n= 275 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
## 1) root 275 159 Adelie (0.421818 0.203636 0.374545)  
##   2) flipper_length&lt; 206.5 168  54 Adelie (0.678571 0.315476 0.005952)  
##     4) bill_length&lt; 42.35 109   1 Adelie (0.990826 0.009174 0.000000) *
##     5) bill_length&gt;=42.35 59   7 Chinstrap (0.101695 0.881356 0.016949) *
##   3) flipper_length&gt;=206.5 107   5 Gentoo (0.018692 0.028037 0.953271) *</code></pre>
<p>Inspecting the output, we see that the learner has identified features in the task that are predictive of the class (the type of penguin) and uses them to partition observations in the tree.
There are additional details on how the data is partitioned across branches of the tree; the textual representation of the model depends on the type of learner.
For more information on this particular type of model, see <a href="https://www.rdocumentation.org/packages/rpart/topics/print.rpart"><code>rpart::print.rpart()</code></a>.</p>
</div>
<div id="predicting" class="section level3" number="2.4.4">
<h3>
<span class="header-section-number">2.4.4</span> Predicting<a class="anchor" aria-label="anchor" href="#predicting"><i class="fas fa-link"></i></a>
</h3>
<p>After the model has been fitted to the training data, we use the test set for prediction.
Remember that we <a href="basics.html#split-data">initially split the data</a> in <code>train_set</code> and <code>test_set</code>.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prediction</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="va">test_set</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;PredictionClassif&gt; for 69 observations:
##     row_ids     truth  response
##           2    Adelie    Adelie
##          11    Adelie    Adelie
##          14    Adelie    Adelie
## ---                            
##         335 Chinstrap Chinstrap
##         339 Chinstrap Chinstrap
##         342 Chinstrap Chinstrap</code></pre>
<p>The <code>$predict()</code> method of the <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> returns a <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> object.
More precisely, a <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a> returns a <a href="https://mlr3.mlr-org.com/reference/PredictionClassif.html"><code>PredictionClassif</code></a> object.</p>
<p>A prediction objects holds the row IDs of the test data, the respective true label of the target column and the respective predictions.
The simplest way to extract this information is by converting the <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> object to a <code>data.table()</code>:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="co"># show first six predictions</span></code></pre></div>
<pre><code>##    row_ids  truth  response
## 1:       2 Adelie    Adelie
## 2:      11 Adelie    Adelie
## 3:      14 Adelie    Adelie
## 4:      16 Adelie    Adelie
## 5:      17 Adelie    Adelie
## 6:      20 Adelie Chinstrap</code></pre>
<p>For classification, you can also extract the confusion matrix:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prediction</span><span class="op">$</span><span class="va">confusion</span></code></pre></div>
<pre><code>##            truth
## response    Adelie Chinstrap Gentoo
##   Adelie        31         0      0
##   Chinstrap      5        10      0
##   Gentoo         0         2     21</code></pre>
<p>The confusion matrix shows, for each class, how many observations were predicted to be in that class and how many were actually in it (more information on <a href="https://en.wikipedia.org/wiki/Confusion_matrix">Wikipedia</a>).
The entries along the diagonal denote the correctly classified observations.
In this case, we can see that our classifier is really quite good and correctly predicting almost all observations.</p>
</div>
<div id="predict-type" class="section level3" number="2.4.5">
<h3>
<span class="header-section-number">2.4.5</span> Changing the Predict Type<a class="anchor" aria-label="anchor" href="#predict-type"><i class="fas fa-link"></i></a>
</h3>
<p>Classification learners default to predicting the class label.
However, many classifiers additionally also tell you how sure they are about the predicted label by providing posterior probabilities for the classes.
To predict these probabilities, the <code>predict_type</code> field of a <a href="https://mlr3.mlr-org.com/reference/LearnerClassif.html"><code>LearnerClassif</code></a> must be changed from <code>"response"</code> (the default) to <code>"prob"</code> before training:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">learner</span><span class="op">$</span><span class="va">predict_type</span> <span class="op">=</span> <span class="st">"prob"</span>

<span class="co"># re-fit the model</span>
<span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="va">train_set</span><span class="op">)</span>

<span class="co"># rebuild prediction object</span>
<span class="va">prediction</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="va">test_set</span><span class="op">)</span></code></pre></div>
<p>The prediction object now contains probabilities for all class labels in addition to the predicted label (the one with the highest probability):</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># data.table conversion</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="co"># show first six</span></code></pre></div>
<pre><code>##    row_ids  truth  response prob.Adelie prob.Chinstrap prob.Gentoo
## 1:       2 Adelie    Adelie      0.9908       0.009174     0.00000
## 2:      11 Adelie    Adelie      0.9908       0.009174     0.00000
## 3:      14 Adelie    Adelie      0.9908       0.009174     0.00000
## 4:      16 Adelie    Adelie      0.9908       0.009174     0.00000
## 5:      17 Adelie    Adelie      0.9908       0.009174     0.00000
## 6:      20 Adelie Chinstrap      0.1017       0.881356     0.01695</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># directly access the predicted labels:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">$</span><span class="va">response</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] Adelie    Adelie    Adelie    Adelie    Adelie    Chinstrap
## Levels: Adelie Chinstrap Gentoo</code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># directly access the matrix of probabilities:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>##      Adelie Chinstrap  Gentoo
## [1,] 0.9908  0.009174 0.00000
## [2,] 0.9908  0.009174 0.00000
## [3,] 0.9908  0.009174 0.00000
## [4,] 0.9908  0.009174 0.00000
## [5,] 0.9908  0.009174 0.00000
## [6,] 0.1017  0.881356 0.01695</code></pre>
<p>Similarly to predicting probabilities for classification, many <a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html"><code>regression learners</code></a> support the extraction of standard error estimates for predictions by setting the predict type to <code>"se"</code>.</p>
</div>
<div id="autoplot-prediction" class="section level3" number="2.4.6">
<h3>
<span class="header-section-number">2.4.6</span> Plotting Predictions<a class="anchor" aria-label="anchor" href="#autoplot-prediction"><i class="fas fa-link"></i></a>
</h3>
<p>Similarly to <a href="basics.html#autoplot-task">plotting tasks</a>, <a href="https://mlr3viz.mlr-org.com">mlr3viz</a> provides an <a href="https://www.rdocumentation.org/packages/ggplot2/topics/autoplot"><code>autoplot()</code></a> method for <a href="https://mlr3.mlr-org.com/reference/Prediction.html"><code>Prediction</code></a> objects.
All available types are listed in the manual pages for <a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionClassif.html"><code>autoplot.PredictionClassif()</code></a>, <a href="https://mlr3viz.mlr-org.com/reference/autoplot.PredictionRegr.html"><code>autoplot.PredictionRegr()</code></a> and the other prediction types (defined by extension packages).</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk</a></span><span class="op">(</span><span class="st">"penguins"</span><span class="op">)</span>
<span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, predict_type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span>
<span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span>
<span class="va">prediction</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-basics-train-predict_files/figure-html/02-basics-train-predict-013-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="measure" class="section level3" number="2.4.7">
<h3>
<span class="header-section-number">2.4.7</span> Performance assessment<a class="anchor" aria-label="anchor" href="#measure"><i class="fas fa-link"></i></a>
</h3>
<p>The last step of modeling is usually assessing the performance of the trained model.
We have already had a look at this with the confusion matrix, but it is often convenient to quantify the performance of a model with a single number.
The exact nature of this comparison is defined by a measure, which is given by a <a href="https://mlr3.mlr-org.com/reference/Measure.html"><code>Measure</code></a> object.
Note that if the prediction was made on a dataset without the target column, i.e. without known true labels, then no performance can be calculated.</p>
<p>Available measures are stored in <a href="https://mlr3.mlr-org.com/reference/mlr_measures.html"><code>mlr_measures</code></a> (with convenience getter function <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html"><code>msr()</code></a>):</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mlr_measures</span></code></pre></div>
<pre><code>## &lt;DictionaryMeasure&gt; with 87 stored values
## Keys: aic, bic, classif.acc, classif.auc, classif.bacc, classif.bbrier,
##   classif.ce, classif.costs, classif.dor, classif.fbeta, classif.fdr,
##   classif.fn, classif.fnr, classif.fomr, classif.fp, classif.fpr,
##   classif.logloss, classif.mbrier, classif.mcc, classif.npv,
##   classif.ppv, classif.prauc, classif.precision, classif.recall,
##   classif.sensitivity, classif.specificity, classif.tn, classif.tnr,
##   classif.tp, classif.tpr, clust.ch, clust.db, clust.dunn,
##   clust.silhouette, clust.wss, debug, dens.logloss, oob_error,
##   regr.bias, regr.ktau, regr.mae, regr.mape, regr.maxae, regr.medae,
##   regr.medse, regr.mse, regr.msle, regr.pbias, regr.rae, regr.rmse,
##   regr.rmsle, regr.rrse, regr.rse, regr.rsq, regr.sae, regr.smape,
##   regr.srho, regr.sse, selected_features, sim.jaccard, sim.phi,
##   surv.brier, surv.calib_alpha, surv.calib_beta, surv.chambless_auc,
##   surv.cindex, surv.dcalib, surv.graf, surv.hung_auc, surv.intlogloss,
##   surv.logloss, surv.mae, surv.mse, surv.nagelk_r2, surv.oquigley_r2,
##   surv.rmse, surv.schmid, surv.song_auc, surv.song_tnr, surv.song_tpr,
##   surv.uno_auc, surv.uno_tnr, surv.uno_tpr, surv.xu_r2, time_both,
##   time_predict, time_train</code></pre>
<p>We choose accuracy (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.acc.html"><code>classif.acc</code></a>) as our specific performance measure here and call the method <code>$score()</code> of the <code>prediction</code> object to quantify the predictive performance of our model.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">measure</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">msr</a></span><span class="op">(</span><span class="st">"classif.acc"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">measure</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;MeasureClassifSimple:classif.acc&gt;
## * Packages: mlr3, mlr3measures
## * Range: [0, 1]
## * Minimize: FALSE
## * Average: macro
## * Parameters: list()
## * Properties: -
## * Predict type: response</code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prediction</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="va">measure</span><span class="op">)</span></code></pre></div>
<pre><code>## classif.acc 
##      0.9651</code></pre>
<p>Note that if no measure is specified, classification defaults to classification error (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_classif.ce.html"><code>classif.ce</code></a>, the inverse of accuracy) and regression to the mean squared error (<a href="https://mlr3.mlr-org.com/reference/mlr_measures_regr.mse.html"><code>regr.mse</code></a>).</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction.html"><span class="header-section-number">1</span> Introduction and Overview</a></div>
<div class="next"><a href="perf-eval-cmp.html"><span class="header-section-number">3</span> Performance Evaluation and Comparison</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basics"><span class="header-section-number">2</span> Basics</a></li>
<li><a class="nav-link" href="#r6"><span class="header-section-number">2.1</span> Quick R6 Intro for Beginners</a></li>
<li>
<a class="nav-link" href="#tasks"><span class="header-section-number">2.2</span> Tasks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tasks-types"><span class="header-section-number">2.2.1</span> Task Types</a></li>
<li><a class="nav-link" href="#tasks-creation"><span class="header-section-number">2.2.2</span> Task Creation</a></li>
<li><a class="nav-link" href="#tasks-predefined"><span class="header-section-number">2.2.3</span> Predefined tasks</a></li>
<li><a class="nav-link" href="#tasks-api"><span class="header-section-number">2.2.4</span> Task API</a></li>
<li><a class="nav-link" href="#autoplot-task"><span class="header-section-number">2.2.5</span> Plotting Tasks</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#learners"><span class="header-section-number">2.3</span> Learners</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#predefined-learners"><span class="header-section-number">2.3.1</span> Predefined Learners</a></li>
<li><a class="nav-link" href="#learner-api"><span class="header-section-number">2.3.2</span> Learner API</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#train-predict"><span class="header-section-number">2.4</span> Train, Predict, Assess Performance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#train-predict-objects"><span class="header-section-number">2.4.1</span> Creating Task and Learner Objects</a></li>
<li><a class="nav-link" href="#split-data"><span class="header-section-number">2.4.2</span> Setting up the train/test splits of the data</a></li>
<li><a class="nav-link" href="#training"><span class="header-section-number">2.4.3</span> Training the learner</a></li>
<li><a class="nav-link" href="#predicting"><span class="header-section-number">2.4.4</span> Predicting</a></li>
<li><a class="nav-link" href="#predict-type"><span class="header-section-number">2.4.5</span> Changing the Predict Type</a></li>
<li><a class="nav-link" href="#autoplot-prediction"><span class="header-section-number">2.4.6</span> Plotting Predictions</a></li>
<li><a class="nav-link" href="#measure"><span class="header-section-number">2.4.7</span> Performance assessment</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mlr-org/mlr3book/blob/main/bookdown/02-basics.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mlr-org/mlr3book/edit/main/bookdown/02-basics.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>mlr3 book</strong>" was written by Marc Becker, Martin Binder, Bernd Bischl, Lars Kotthoff, Michel Lang, Florian Pfisterer, Nicholas G. Reich, Jakob Richter, Patrick Schratz, Raphael Sonabend, Damir Pulatov. It was last built on 2021-11-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
